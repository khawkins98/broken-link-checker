{"version":3,"file":"HtmlUrlChecker.js","names":["_events","require","_HtmlChecker","_interopRequireDefault","_parseOptions","_limitedRequestQueue","_interopRequireWildcard","_robotDirectives","_SafeEventEmitter","_streamHTML","_httpProtocol","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","obj","_classPrivateMethodInitSpec","privateSet","_checkPrivateRedeclaration","add","_classPrivateFieldInitSpec","privateMap","value","privateCollection","TypeError","_classPrivateFieldGet","receiver","descriptor","_classExtractFieldDescriptor","_classApplyDescriptorGet","_classPrivateFieldSet","_classApplyDescriptorSet","action","writable","_classPrivateMethodGet","fn","_currentAuth","_currentCustomData","_currentDone","_currentPageURL","_currentResponse","_currentRobots","_htmlChecker","_htmlUrlQueue","_options","_appendRobotHeaders","WeakSet","_completedPage","_reset","HtmlUrlChecker","SafeEventEmitter","constructor","options","_reset2","parseOptions","RequestQueue","maxSockets","rateLimit","on","ITEM_EVENT","url","auth","customData","done","response","stream","streamHTML","__cache","RobotDirectives","userAgent","_appendRobotHeaders2","finalPageURL","scan","error","_completedPage2","REQUEST_QUEUE_END_EVENT","emit","END_EVENT","HtmlChecker","ERROR_EVENT","HTML_EVENT","tree","robots","QUEUE_EVENT","JUNK_EVENT","result","LINK_EVENT","COMPLETE_EVENT","clearCache","dequeue","id","success","enqueue","pageURL","transitive","transitiveAuth","isPaused","numActiveLinks","numPages","length","numQueuedLinks","pause","resume","exports","_classPrivateFieldGet2","xRobotsTag","headers","header","PAGE_EVENT","module"],"sources":["../../lib/public/HtmlUrlChecker.js"],"sourcesContent":["import {COMPLETE_EVENT, END_EVENT, ERROR_EVENT, HTML_EVENT, JUNK_EVENT, LINK_EVENT, PAGE_EVENT, QUEUE_EVENT} from \"../internal/events\";\nimport HtmlChecker from \"./HtmlChecker\";\nimport parseOptions from \"../internal/parseOptions\";\nimport RequestQueue, {ITEM_EVENT, END_EVENT as REQUEST_QUEUE_END_EVENT} from \"limited-request-queue\";\nimport RobotDirectives from \"robot-directives\";\nimport SafeEventEmitter from \"../internal/SafeEventEmitter\";\nimport streamHTML from \"../internal/streamHTML\";\nimport {transitiveAuth} from \"../internal/http-protocol\";\n\n\n\nexport default class HtmlUrlChecker extends SafeEventEmitter\n{\n\t#currentAuth;\n\t#currentCustomData;\n\t#currentDone;\n\t#currentPageURL;\n\t#currentResponse;\n\t#currentRobots;\n\t#htmlChecker;\n\t#htmlUrlQueue;\n\t#options;\n\n\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.#reset();\n\n\t\tthis.#options = parseOptions(options);\n\n\t\tthis.#htmlUrlQueue = new RequestQueue(\n\t\t{\n\t\t\tmaxSockets: 1,\n\t\t\trateLimit: this.#options.rateLimit\n\t\t})\n\t\t.on(ITEM_EVENT, async (url, {auth, customData}, done) =>\n\t\t{\n\t\t\tthis.#reset();\n\n\t\t\tthis.#currentAuth = auth;\n\t\t\tthis.#currentCustomData = customData;\n\t\t\tthis.#currentDone = done;\n\t\t\tthis.#currentPageURL = url;  // @todo remove hash ?\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst {response, stream} = await streamHTML(this.#currentPageURL, this.#currentAuth, this.__cache, this.#options);\n\n\t\t\t\t// Is only defined for HTTP -- made null for consistency\n\t\t\t\tthis.#currentResponse = response ?? null;\n\n\t\t\t\tthis.#currentRobots = new RobotDirectives({ userAgent: this.#options.userAgent });\n\n\t\t\t\tthis.#appendRobotHeaders();\n\n\t\t\t\t// If redirected for HTTP, or original URL for non-HTTP\n\t\t\t\tconst finalPageURL = response?.url ?? this.#currentPageURL;\n\n\t\t\t\t// Passes robots instance so that headers are included in robot exclusion checks\n\t\t\t\t// @todo does the `await` cause `completedPage` to be called twice (other's in COMPLETE_EVENT) if error occurs?\n\t\t\t\tawait this.#htmlChecker.scan(stream, finalPageURL, this.#currentRobots, this.#currentAuth);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.#completedPage(error);\n\t\t\t}\n\t\t})\n\t\t.on(REQUEST_QUEUE_END_EVENT, () =>\n\t\t{\n\t\t\t// Clear references for garbage collection\n\t\t\tthis.#reset();\n\n\t\t\tthis.emit(END_EVENT);\n\t\t});\n\n\t\tthis.#htmlChecker = new HtmlChecker(this.#options)\n\t\t.on(ERROR_EVENT, error => this.emit(ERROR_EVENT, error))\n\t\t.on(HTML_EVENT, (tree, robots) =>\n\t\t{\n\t\t\tthis.emit(HTML_EVENT, tree, robots, this.#currentResponse, this.#currentPageURL, this.#currentCustomData);\n\t\t})\n\t\t.on(QUEUE_EVENT, () => this.emit(QUEUE_EVENT))\n\t\t.on(JUNK_EVENT, result => this.emit(JUNK_EVENT, result, this.#currentCustomData))\n\t\t.on(LINK_EVENT, result => this.emit(LINK_EVENT, result, this.#currentCustomData))\n\t\t.on(COMPLETE_EVENT, () => this.#completedPage());\n\t}\n\n\n\n\t/**\n\t * Append any robot headers.\n\t */\n\t#appendRobotHeaders()\n\t{\n\t\tconst xRobotsTag = this.#currentResponse?.headers[\"x-robots-tag\"];\n\n\t\t// @todo https://github.com/nodejs/node/issues/3591\n\t\tif (xRobotsTag != null)\n\t\t{\n\t\t\tthis.#currentRobots.header(xRobotsTag);\n\t\t}\n\t}\n\n\n\n\tclearCache()\n\t{\n\t\tthis.#htmlChecker.clearCache();\n\t\treturn this;\n\t}\n\n\n\n\t/**\n\t * Emit PAGE_EVENT and continue the queue.\n\t * @param {Error} [error]\n\t */\n\t#completedPage(error = null)\n\t{\n\t\t// @todo emit page error instead?\n\t\t// @todo include redirected url if there is one?\n\t\tthis.emit(PAGE_EVENT, error, this.#currentPageURL, this.#currentCustomData);\n\n\t\t// Auto-starts next queue item, if any\n\t\t// Emits REQUEST_QUEUE_END_EVENT, if not\n\t\tthis.#currentDone();\n\t}\n\n\n\n\tdequeue(id)\n\t{\n\t\tconst success = this.#htmlUrlQueue.dequeue(id);\n\n\t\tthis.emit(QUEUE_EVENT);\n\n\t\treturn success;\n\t}\n\n\n\n\t// `auth` is undocumented and for internal use only\n\tenqueue(pageURL, customData, auth)\n\t{\n\t\t// @todo this could get messy if there're many different credentials per site (if we cache based on headers)\n\t\tconst transitive = transitiveAuth(pageURL, auth);\n\n\t\tconst id = this.#htmlUrlQueue.enqueue(transitive.url, { auth:transitive.auth, customData });\n\n\t\tthis.emit(QUEUE_EVENT);\n\n\t\treturn id;\n\t}\n\n\n\n\thas(id)\n\t{\n\t\treturn this.#htmlUrlQueue.has(id);\n\t}\n\n\n\n\tget isPaused()\n\t{\n\t\treturn this.#htmlChecker.isPaused;\n\t}\n\n\n\n\tget numActiveLinks()\n\t{\n\t\treturn this.#htmlChecker.numActiveLinks;\n\t}\n\n\n\n\tget numPages()\n\t{\n\t\treturn this.#htmlUrlQueue.length;\n\t}\n\n\n\n\tget numQueuedLinks()\n\t{\n\t\treturn this.#htmlChecker.numQueuedLinks;\n\t}\n\n\n\n\tpause()\n\t{\n\t\tthis.#htmlChecker.pause();\n\t\tthis.#htmlUrlQueue.pause();\n\t\treturn this;\n\t}\n\n\n\n\t#reset()\n\t{\n\t\tthis.#currentAuth = null;\n\t\tthis.#currentCustomData = null;\n\t\tthis.#currentDone = null;\n\t\tthis.#currentPageURL = null;\n\t\tthis.#currentResponse = null;\n\t\tthis.#currentRobots = null;\n\t}\n\n\n\n\tresume()\n\t{\n\t\tthis.#htmlChecker.resume();\n\t\tthis.#htmlUrlQueue.resume();\n\t\treturn this;\n\t}\n\n\n\n\tget __cache()\n\t{\n\t\treturn this.#htmlChecker.__cache;\n\t}\n}\n"],"mappings":"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"}